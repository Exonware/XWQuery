// hcl.grammar
// HCL Grammar - HashiCorp Configuration Language
// Based on HCL 2.x specification
// Company: eXonware.com

?start: body

body: (attribute | block)*

attribute: IDENTIFIER "=" expression NEWLINE

block: block_label* "{" body "}"

block_label: IDENTIFIER | string_literal

expression: expr_term (operator expr_term)*

expr_term: literal_value
          | variable_expr
          | function_call
          | collection_value
          | "(" expression ")"
          | unary_op expression

variable_expr: IDENTIFIER ("." IDENTIFIER)*

function_call: IDENTIFIER "(" (expression ("," expression)*)? ")"

collection_value: object_value | tuple_value

object_value: "{" (object_elem ("," object_elem)* ","?)? "}"

object_elem: (IDENTIFIER | string_literal) "=" expression

tuple_value: "[" (expression ("," expression)* ","?)? "]"

literal_value: string_literal
             | number_literal
             | boolean_literal
             | null_literal

string_literal: QUOTED_STRING | HEREDOC

QUOTED_STRING: "\"" /[^"\\]|\\["\\/bfnrt]|\\u[0-9a-fA-F]{4}/* "\""

HEREDOC: /<<[-]?["]?[a-zA-Z0-9_-]+["]?/ /[^\n]*\n/ /[^]*?/ /[a-zA-Z0-9_-]+/

number_literal: DEC_NUMBER | HEX_NUMBER | FLOAT_NUMBER

DEC_NUMBER: /[0-9]+/

HEX_NUMBER: /0[xX][0-9a-fA-F]+/

FLOAT_NUMBER: /[0-9]+\.[0-9]+([eE][+-]?[0-9]+)?/

boolean_literal: "true" | "false"

null_literal: "null"

operator: "+" | "-" | "*" | "/" | "%" | "==" | "!=" | "<" | ">" | "<=" | ">=" | "&&" | "||"

unary_op: "-" | "!"

IDENTIFIER: /[a-zA-Z_][a-zA-Z0-9_-]*/

%import common.WS
%import common.NEWLINE

%ignore WS

