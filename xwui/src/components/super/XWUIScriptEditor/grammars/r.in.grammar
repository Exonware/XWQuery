// r.grammar
// R Grammar - Statistical Computing Language
// Based on R language specification
// Company: eXonware.com

?start: expr

expr: expr (op expr)*
    | function_call
    | assignment
    | control_flow
    | literal
    | variable
    | "(" expr ")"

function_call: IDENTIFIER "(" (expr ("," expr)*)? ")"

assignment: variable ("<-" | "=" | "<<-") expr

variable: IDENTIFIER ("$" IDENTIFIER)* ("[" expr "]")*

control_flow: if_expr | for_expr | while_expr | repeat_expr

if_expr: "if" "(" expr ")" expr ("else" expr)?

for_expr: "for" "(" IDENTIFIER "in" expr ")" expr

while_expr: "while" "(" expr ")" expr

repeat_expr: "repeat" expr

literal: number | string | logical | NULL | NA

number: INTEGER | FLOAT | COMPLEX

INTEGER: /[0-9]+[Ll]?/

FLOAT: /[0-9]+\.[0-9]*([eE][+-]?[0-9]+)?[iL]?/

COMPLEX: /[0-9]+\.[0-9]*[eE][+-]?[0-9]+i/

string: STRING | RAW_STRING

STRING: "\"" /[^"\\]|\\["\\/bfnrt]|\\u[0-9a-fA-F]{4}/* "\"" | "'" /[^'\\]|\\['\\/bfnrt]|\\u[0-9a-fA-F]{4}/* "'"

RAW_STRING: "r\"" /[^"]/* "\""

logical: "TRUE" | "FALSE" | "T" | "F"

NULL: "NULL"

NA: "NA"

op: "+" | "-" | "*" | "/" | "^" | "%%" | "%/%" | "==" | "!=" | "<" | ">" | "<=" | ">=" | "&" | "|" | "&&" | "||"

IDENTIFIER: /[a-zA-Z._][a-zA-Z0-9._]*/

%import common.WS
%import common.NEWLINE

%ignore WS

